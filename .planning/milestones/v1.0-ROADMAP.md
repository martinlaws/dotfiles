# Milestone v1.0: MVP - Mac Setup Automation

**Status:** âœ… SHIPPED 2026-02-02
**Phases:** 1-6
**Total Plans:** 17

## Overview

Transform Mac setup from painful manual chore into delightful automated experience through six focused phases: establish foundation with Homebrew and development tools, automate dotfiles symlinking with SSH/Git configuration, install GUI applications with beautiful CLI prompts, enable safe re-run for long-term maintenance, fix critical integration breaks in update mode, and close all remaining gaps for 100% hands-off setup.

## Phases

### Phase 1: Foundation & Core Tools

**Goal**: User can run setup script on fresh Mac and get Homebrew with essential CLI tools installed
**Depends on**: Nothing (first phase)
**Plans**: 4 plans

Plans:
- [x] 01-01: Project structure and Homebrew installation with beautiful UI
- [x] 01-02: CLI tools installation and completion report
- [x] 01-03: [GAP CLOSURE] Fix UI fallback artifacts and defensive Homebrew check
- [x] 01-04: [GAP CLOSURE] Fix Xcode CLT auto-installation and Homebrew password prompt

**Details:**
- Modular script structure (setup, scripts/lib/, config/)
- Reusable UI library with Gum wrapper functions
- Architecture detection (Apple Silicon vs Intel)
- Xcode CLT and Homebrew installation automation
- 9 CLI tools via Brewfile (git, node, pnpm, fnm, gh, tree, gum, stow, starship, opencode, jq)
- Beautiful CLI with progress indicators and clear sections

### Phase 2: Dotfiles & Developer Config

**Goal**: User's dotfiles are symlinked and development environment is configured with SSH/Git
**Depends on**: Phase 1
**Plans**: 3 plans

Plans:
- [x] 02-01: Reorganize dotfiles for Stow and create symlink script
- [x] 02-02: SSH key setup and Git configuration scripts
- [x] 02-03: Integration into setup flow and completion verification

**Details:**
- 5 stow-compatible packages (shell, git, terminal, editors, ssh)
- Template-based .gitconfig with {{NAME}}/{{EMAIL}} placeholders
- Local override pattern (*.local files) for machine-specific settings
- SSH key detection and generation (Ed25519 with keychain integration)
- Git configuration from template or interactive prompts
- Backup functionality to prevent data loss

### Phase 3: Applications & System Settings

**Goal**: User's curated apps are installed and macOS preferences match their workflow
**Depends on**: Phase 2
**Plans**: 3 plans

Plans:
- [x] 03-01: GUI application installation with selection flow (all/categories/individual)
- [x] 03-02: macOS system settings configuration with preview
- [x] 03-03: Integration into setup flow and completion report

**Details:**
- 21 GUI apps categorized (Browsers, Dev Tools, Communication, Creative, Utilities, Productivity, Gaming)
- Three-tier selection model (all/categories/individual)
- Interactive Brewfile generation for filtered installation
- System settings: mouse/trackpad speed, keyboard repeat, screenshots, Finder, Dock
- Preview and customization UI before applying settings
- Completion report with actual verification

### Phase 4: Maintenance & Updates

**Goal**: User can safely re-run setup to update packages and configs without breaking existing setup
**Depends on**: Phase 3
**Plans**: 4 plans

Plans:
- [x] 04-01: State management and backup infrastructure
- [x] 04-02: Update category scripts (Homebrew, dotfiles, system, apps)
- [x] 04-03: Integration into setup entry point and completion report
- [x] 04-04: [GAP CLOSURE] Fix function call order in show-report.sh

**Details:**
- State file at ~/.local/state/dotfiles/ (outside git repo)
- Package list tracking for drift detection
- Backup system (keep last 5 backups)
- Logging system (detailed logs to file, clean terminal UI)
- Update mode detection and routing
- Content drift detection for dotfiles
- Type-aware comparison for macOS defaults
- Package-level reporting with version details

### Phase 5: Fix Update Mode Integration Breaks

**Goal**: Fix 2 critical one-line errors blocking update mode functionality
**Depends on**: Phase 4
**Plans**: 1 plan

Plans:
- [x] 05-01: Fix stow package names and Brewfile reference in update scripts

**Details:**
- Fixed update-dotfiles.sh STOW_PACKAGES to match actual package directories
- Fixed update-apps.sh BREWFILE path to point to Brewfile.apps (not CLI tools Brewfile)
- Enabled full update mode functionality

### Phase 6: Gap Closure Fixes

**Goal**: Fix immediate blocking bugs + achieve 100% hands-off automation (29/29 requirements)
**Depends on**: Phase 5
**Plans**: 2 plans

Plans:
- [x] 06-01: Fix SCRIPT_DIR bug, add starship, move claude, fix echo fallback, add error handling
- [x] 06-02: [GAP CLOSURE] Fix SCRIPT_DIR collision in configure-system.sh

**Details:**
- Fixed SCRIPT_DIR collision in sourced scripts (use SCRIPTS_DIR)
- Added starship to Brewfile (required for .zshrc)
- Moved claude to Brewfile.apps as cask (not CLI tool)
- Fixed echo -e artifacts (replaced with printf)
- Added set -euo pipefail for error propagation
- Added Homebrew verification before Phase 3
- Complete 100% Bash 3.2 compatibility (fixed process substitution, nameref, variable quoting)

---

## Milestone Summary

**Decimal Phases:**
None (all integer phases)

**Key Decisions:**
- Modular script structure from start (easy maintenance)
- GNU Stow for dotfiles management (industry standard)
- Gum for CLI UI with fallbacks (beautiful + robust)
- State management outside git repo (XDG spec compliance)
- Template-based configs with local overrides (multi-machine support)
- Bash 3.2 compatibility (works on macOS default shell)

**Issues Resolved:**
- Bash 3.2 compatibility (process substitution, nameref, variable quoting)
- SCRIPT_DIR collision in sourced scripts
- Invalid "dia" cask (should be "arc")
- Echo -e artifacts on macOS
- Xcode CLT auto-installation
- Update mode integration breaks

**Technical Debt Incurred:**
None - all gaps closed in Phase 6

---

*For current project status, see .planning/PROJECT.md*
